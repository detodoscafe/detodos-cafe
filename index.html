<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>De Todos Caf√© - Men√∫ Digital & Pedidos</title>

  <meta name="description" content="Men√∫ digital de De Todos Caf√©. Pedidos por WhatsApp: Caf√©, limonadas granizadas, sodas, granizados y combos. Delivery disponible.">
  <meta name="keywords" content="caf√©, men√∫ digital, pedidos WhatsApp, limonadas, granizados, delivery, comida r√°pida, bebidas">
  <meta name="author" content="De Todos Caf√©">

  <!-- Favicon -->
  <link rel="icon" href="data:image/svg+xml,<svg xmlns=%22http://www.w3.org/2000/svg%22 viewBox=%220 0 100 100%22><text y=%22.9em%22 font-size=%2290%22>‚òï</text></svg>">
  
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css"/>
  <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@300;400;500;600;700&family=Inter:wght@300;400;500;600&display=swap" rel="stylesheet"/>

  <style>
    :root{
      --cafe-oscuro:#3b1f0f; --cafe-medio:#8B4513; --cafe-claro:#D2691E;
      --whatsapp:#25D366; --texto:#2C1810; --acento:#FF6B35; --border:#E8D9C5;
      --bg:#faf7f2; --rojo-temu:#ff3b30; --verde-temu:#34c759; --naranja-temu:#ff9500;
    }
    *{margin:0;padding:0;box-sizing:border-box}
    html{scroll-behavior:smooth}
    body{
      font-family:'Inter','Segoe UI',sans-serif;
      background:linear-gradient(135deg,#f7f3ef 0%,#f0e6d6 100%);
      color:var(--texto); line-height:1.6; min-height:100vh;
      padding-bottom:80px; /* Espacio para bot√≥n flotante */
    }

    .header{
      background:linear-gradient(to right,var(--cafe-oscuro),var(--cafe-medio));
      color:#fff; text-align:center; padding:1.2rem 1rem;
      position:sticky; top:0; z-index:1000;
      box-shadow:0 4px 12px rgba(59,31,15,.2);
    }
    .logo{
      font-family:'Poppins',sans-serif; font-size:1.8rem; font-weight:700;
      display:flex; align-items:center; justify-content:center; gap:0.8rem;
      margin-bottom:0.3rem;
    }
    .logo i{color:var(--cafe-claro)}
    .subtitle{font-size:0.9rem;opacity:.9}

    .container{
      max-width:1400px; margin:0 auto; padding:1.5rem 1rem;
    }

    /* MEN√ö DE CATEGOR√çAS FIJAS EN LATERAL IZQUIERDO */
    .menu-categorias {
      position: fixed;
      left: 20px;
      top: 50%;
      transform: translateY(-50%);
      background: #fff;
      border-radius: 15px;
      box-shadow: 0 5px 20px rgba(0,0,0,0.1);
      padding: 1rem;
      z-index: 900;
      display: flex;
      flex-direction: column;
      gap: 0.5rem;
      max-height: 70vh;
      overflow-y: auto;
      width: 200px;
      display: none; /* Oculto por defecto en m√≥vil */
    }

    @media(min-width:1024px){
      .menu-categorias {
        display: flex;
      }
      .container {
        margin-left: 240px; /* Espacio para men√∫ lateral */
      }
    }

    .categoria-btn {
      background: transparent;
      border: none;
      padding: 0.8rem 1rem;
      border-radius: 10px;
      text-align: left;
      cursor: pointer;
      transition: all 0.2s;
      font-weight: 600;
      color: var(--texto);
      display: flex;
      align-items: center;
      gap: 0.8rem;
      font-size: 0.9rem;
    }

    .categoria-btn:hover,
    .categoria-btn.activa {
      background: linear-gradient(to right, var(--cafe-claro), var(--cafe-medio));
      color: #fff;
    }

    .categoria-btn i {
      width: 20px;
      text-align: center;
    }

    /* BOT√ìN PARA MOSTRAR CATEGOR√çAS EN M√ìVIL */
    .btn-categorias-movil {
      position: fixed;
      bottom: 90px;
      left: 20px;
      background: linear-gradient(to right, var(--cafe-medio), var(--cafe-claro));
      color: #fff;
      border: none;
      width: 50px;
      height: 50px;
      border-radius: 50%;
      display: flex;
      align-items: center;
      justify-content: center;
      font-size: 1.2rem;
      cursor: pointer;
      z-index: 999;
      box-shadow: 0 4px 15px rgba(139,69,19,0.3);
      display: none;
    }

    @media(max-width:1023px){
      .btn-categorias-movil {
        display: flex;
      }
    }

    /* CONTENIDO DE CATEGOR√çAS */
    .categoria-contenido {
      display: none;
      animation: fadeIn 0.3s ease;
    }

    .categoria-contenido.activa {
      display: block;
    }

    @keyframes fadeIn {
      from { opacity: 0; transform: translateY(10px); }
      to { opacity: 1; transform: translateY(0); }
    }

    /* ========== ESTILO TEMU PARA PRODUCTOS ========== */
    .grid-productos{
      display:grid; grid-template-columns:repeat(2, 1fr);
      gap:1rem;
    }
    @media(min-width:768px){.grid-productos{grid-template-columns:repeat(3, 1fr)}}
    @media(min-width:1024px){.grid-productos{grid-template-columns:repeat(4, 1fr)}}

    .producto-temu{
      background:#fff; border-radius:12px; padding:1rem;
      border:1px solid #eaeaea; transition:all .25s ease;
      display:flex; flex-direction:column; height:100%;
      position:relative; overflow:hidden;
      box-shadow:0 2px 8px rgba(0,0,0,0.05);
    }
    .producto-temu:hover{
      transform:translateY(-3px); 
      box-shadow:0 6px 16px rgba(0,0,0,0.1);
      border-color:var(--cafe-claro);
    }

    /* Badge de stock al estilo Temu */
    .badge-stock-temu {
      position: absolute;
      top: 10px;
      right: 10px;
      background: var(--rojo-temu);
      color: #fff;
      font-size: 0.7rem;
      font-weight: 900;
      padding: 0.2rem 0.5rem;
      border-radius: 10px;
      z-index: 2;
    }

    .badge-promo-temu {
      position: absolute;
      top: 10px;
      left: 10px;
      background: var(--naranja-temu);
      color: #fff;
      font-size: 0.7rem;
      font-weight: 900;
      padding: 0.2rem 0.5rem;
      border-radius: 10px;
      z-index: 2;
    }

    .img-placeholder-temu {
      width: 100%;
      height: 140px;
      background: linear-gradient(135deg, #f5f5f5, #e0e0e0);
      border-radius: 8px;
      display: flex;
      align-items: center;
      justify-content: center;
      margin-bottom: 0.8rem;
      overflow: hidden;
      position: relative;
    }

    .img-placeholder-temu i {
      font-size: 2.5rem;
      color: var(--cafe-medio);
      opacity: 0.5;
    }

    .nombre-producto-temu{
      font-weight:800;font-size:0.95rem;margin-bottom:0.3rem;color:var(--cafe-oscuro);
      min-height:2.2rem; display:-webkit-box; -webkit-line-clamp:2; -webkit-box-orient:vertical; overflow:hidden;
      line-height:1.3;
    }

    .descripcion-corta-temu {
      font-size: 0.8rem;
      color: #666;
      margin-bottom: 0.5rem;
      display: -webkit-box;
      -webkit-line-clamp: 2;
      -webkit-box-orient: vertical;
      overflow: hidden;
      line-height: 1.3;
    }

    .precio-temu{
      font-weight:900;font-size:1.25rem;color:var(--rojo-temu);margin:0.5rem 0 0.3rem 0;
    }

    .precio-original-temu {
      font-size: 0.85rem;
      color: #999;
      text-decoration: line-through;
      margin-right: 0.3rem;
    }

    .envio-gratis-temu {
      display: inline-block;
      background: var(--verde-temu);
      color: #fff;
      font-size: 0.7rem;
      padding: 0.15rem 0.4rem;
      border-radius: 4px;
      margin-top: 0.2rem;
    }

    .rating-temu {
      display: flex;
      align-items: center;
      gap: 0.2rem;
      margin: 0.3rem 0;
    }

    .rating-temu i {
      color: #ffc107;
      font-size: 0.8rem;
    }

    .rating-temu span {
      font-size: 0.8rem;
      color: #666;
      margin-left: 0.3rem;
    }

    /* Bot√≥n de agregar al estilo Temu */
    .btn-agregar-temu{
      width:100%;
      background:linear-gradient(to right,var(--rojo-temu),var(--naranja-temu));
      color:#fff;border:none;padding:0.7rem;border-radius:10px;
      font-weight:900;font-size:0.9rem;cursor:pointer;
      display:flex;align-items:center;justify-content:center;gap:.5rem;
      transition:all .25s; margin-top:auto;
      position:relative;
      overflow:hidden;
    }
    .btn-agregar-temu:hover{
      transform:translateY(-1px);
      box-shadow:0 4px 12px rgba(255,59,48,0.3);
    }

    .btn-agregar-temu:active{
      transform:translateY(0);
    }

    .btn-agregar-temu i {
      transition: transform 0.2s;
    }

    .btn-agregar-temu:hover i {
      transform: scale(1.2);
    }

    /* ========== CARRITO FLOTANTE AL ESTILO TEMU ========== */
    /* BOT√ìN CARRITO FLOTANTE - TEMU STYLE */
    .carrito-boton-flotante {
      position: fixed;
      bottom: 20px;
      right: 20px;
      z-index: 9999;
    }

    .btn-carrito-flotante-temu {
      background: linear-gradient(to right, var(--rojo-temu), var(--naranja-temu));
      color: #fff;
      border: none;
      padding: 1rem 1.5rem;
      border-radius: 50px;
      font-size: 1rem;
      font-weight: 900;
      cursor: pointer;
      display: flex;
      align-items: center;
      justify-content: center;
      gap: 0.6rem;
      transition: all 0.3s;
      box-shadow: 0 6px 20px rgba(255, 59, 48, 0.3);
      min-width: 200px;
      position: relative;
    }

    @media(max-width:768px){
      .btn-carrito-flotante-temu {
        min-width: 60px;
        width: 60px;
        height: 60px;
        border-radius: 50%;
        padding: 0;
      }
      .btn-carrito-flotante-temu span {
        display: none;
      }
    }

    .btn-carrito-flotante-temu:hover {
      transform: translateY(-3px) scale(1.05);
      box-shadow: 0 8px 25px rgba(255, 59, 48, 0.4);
    }

    .badge-carrito-flotante-temu {
      position: absolute;
      top: -8px;
      right: -8px;
      background: #fff;
      color: var(--rojo-temu);
      width: 26px;
      height: 26px;
      border-radius: 50%;
      display: flex;
      align-items: center;
      justify-content: center;
      font-size: 0.8rem;
      font-weight: 900;
      border: 2px solid var(--rojo-temu);
      box-shadow: 0 2px 5px rgba(0,0,0,0.2);
    }

    @media(max-width:768px){
      .badge-carrito-flotante-temu {
        top: -5px;
        right: -5px;
        width: 22px;
        height: 22px;
        font-size: 0.7rem;
      }
    }

    /* CARRITO FLOTANTE TEMU */
    .carrito-flotante-temu {
      position: fixed;
      bottom: 90px;
      right: 20px;
      width: 380px;
      max-height: 550px;
      background: #fff;
      border-radius: 15px;
      box-shadow: 0 10px 30px rgba(0, 0, 0, 0.15);
      z-index: 9998;
      overflow: hidden;
      display: none;
      transition: all 0.3s ease;
      border: 1px solid #e0e0e0;
    }

    .carrito-flotante-temu.abierto {
      display: flex;
      flex-direction: column;
      animation: slideUp 0.3s ease;
    }

    @keyframes slideUp {
      from {
        opacity: 0;
        transform: translateY(20px);
      }
      to {
        opacity: 1;
        transform: translateY(0);
      }
    }

    .cabecera-carrito-flotante-temu {
      background: linear-gradient(to right, var(--rojo-temu), var(--naranja-temu));
      color: #fff;
      padding: 1rem 1.2rem;
      display: flex;
      justify-content: space-between;
      align-items: center;
    }

    .cabecera-carrito-flotante-temu h3 {
      font-family: 'Poppins', sans-serif;
      font-size: 1.2rem;
      margin: 0;
      display: flex;
      align-items: center;
      gap: 0.5rem;
    }

    .badge-carrito-cabecera-temu {
      background: #fff;
      color: var(--rojo-temu);
      width: 24px;
      height: 24px;
      border-radius: 50%;
      display: inline-flex;
      align-items: center;
      justify-content: center;
      font-size: 0.75rem;
      font-weight: 900;
    }

    .btn-cerrar-carrito-temu {
      background: transparent;
      border: 1px solid rgba(255,255,255,0.3);
      color: #fff;
      padding: 0.4rem 0.8rem;
      border-radius: 10px;
      font-size: 0.8rem;
      cursor: pointer;
      transition: all 0.25s;
    }

    .btn-cerrar-carrito-temu:hover {
      background: rgba(255,255,255,0.1);
    }

    .contenido-carrito-flotante-temu {
      flex: 1;
      overflow-y: auto;
      padding: 1.2rem;
    }

    .items-carrito-flotante-temu {
      max-height: 220px;
      overflow-y: auto;
      margin-bottom: 1.2rem;
    }

    .item-carrito-flotante-temu {
      display: flex;
      justify-content: space-between;
      align-items: flex-start;
      gap: 0.8rem;
      padding: 0.8rem;
      margin-bottom: 0.8rem;
      background: #f9f9f9;
      border-radius: 10px;
      border: 1px solid #eaeaea;
    }

    .info-item-flotante-temu {
      flex: 1;
    }

    .nombre-item-flotante-temu {
      font-weight: 900;
      font-size: 0.9rem;
      margin-bottom: 0.3rem;
      color: #333;
    }

    .precio-unitario-flotante-temu {
      font-size: 0.85rem;
      color: var(--rojo-temu);
      font-weight: 900;
    }

    .qty-row-flotante-temu {
      display: flex;
      align-items: center;
      gap: 0.5rem;
      margin-top: 0.5rem;
    }

    .btn-qty-flotante-temu {
      width: 28px;
      height: 28px;
      border-radius: 8px;
      border: 1px solid #ddd;
      background: #fff;
      cursor: pointer;
      font-weight: 900;
      font-size: 0.9rem;
      display: flex;
      align-items: center;
      justify-content: center;
      transition: all 0.2s;
    }

    .btn-qty-flotante-temu:hover {
      border-color: var(--rojo-temu);
      background: #fff5f5;
    }

    .qty-flotante-temu {
      min-width: 24px;
      text-align: center;
      font-weight: 900;
      color: #333;
    }

    .total-item-flotante-temu {
      font-weight: 900;
      color: var(--rojo-temu);
      font-size: 1rem;
    }

    .btn-x-flotante-temu {
      background: transparent;
      border: 1px solid #ddd;
      border-radius: 10px;
      padding: 0.3rem 0.6rem;
      cursor: pointer;
      font-size: 0.8rem;
      transition: all 0.2s;
    }

    .btn-x-flotante-temu:hover {
      border-color: var(--rojo-temu);
      background: #fff5f5;
      color: var(--rojo-temu);
    }

    .total-pedido-flotante-temu {
      border-top: 2px solid #eee;
      padding-top: 1rem;
      margin-bottom: 1rem;
    }

    .fila-total-flotante-temu {
      display: flex;
      justify-content: space-between;
      margin-bottom: 0.5rem;
      font-size: 0.95rem;
    }

    .monto-total-flotante-temu {
      font-weight: 900;
      font-size: 1.3rem;
      color: var(--rojo-temu);
    }

    .opciones-carrito-flotante-temu {
      border: 1px dashed #ddd;
      border-radius: 12px;
      padding: 1rem;
      margin-bottom: 1.2rem;
      background: #fcfcfc;
    }

    .titulo-bloque-flotante-temu {
      font-weight: 900;
      font-size: 0.95rem;
      color: #333;
      display: flex;
      align-items: center;
      gap: 0.4rem;
      margin-bottom: 0.8rem;
    }

    .fila-opciones-flotante-temu {
      display: flex;
      flex-direction: column;
      gap: 0.4rem;
      margin: 0.5rem 0 0.8rem 0;
    }

    .label-mini-flotante-temu {
      font-size: 0.8rem;
      color: #666;
      font-weight: 700;
    }

    select.flotante-temu, input.flotante-temu {
      width: 100%;
      padding: 0.7rem 0.8rem;
      border: 1px solid #ddd;
      border-radius: 10px;
      background: #fff;
      font-family: inherit;
      font-size: 0.9rem;
      outline: none;
      transition: border 0.2s;
    }

    select.flotante-temu:focus, input.flotante-temu:focus {
      border-color: var(--rojo-temu);
    }

    .mini-ayuda-flotante-temu {
      font-size: 0.8rem;
      color: #666;
      margin-top: 0.3rem;
    }

    .mensaje-vacio-flotante-temu {
      text-align: center;
      padding: 2rem 1rem;
      color: #999;
    }

    .mensaje-vacio-flotante-temu i {
      font-size: 3rem;
      margin-bottom: 1rem;
      opacity: 0.3;
    }

    .mensaje-vacio-flotante-temu p {
      margin-bottom: 0.5rem;
    }

    /* BOT√ìN WHATSAPP DENTRO DEL CARRITO TEMU */
    .btn-whatsapp-carrito-temu {
      background: linear-gradient(to right, var(--whatsapp), #1da851);
      color: #fff;
      border: none;
      width: 100%;
      padding: 1rem;
      border-radius: 12px;
      font-size: 1rem;
      font-weight: 900;
      cursor: pointer;
      display: flex;
      align-items: center;
      justify-content: center;
      gap: 0.6rem;
      transition: all 0.3s;
      box-shadow: 0 4px 14px rgba(37, 211, 102, 0.3);
      margin-top: 1rem;
    }

    .btn-whatsapp-carrito-temu:hover:not(:disabled) {
      transform: translateY(-2px);
      box-shadow: 0 6px 18px rgba(37, 211, 102, 0.4);
    }

    .btn-whatsapp-carrito-temu:disabled {
      opacity: 0.6;
      cursor: not-allowed;
      transform: none;
      box-shadow: none;
    }

    /* Overlay para cerrar carrito */
    .overlay-carrito-temu {
      position: fixed;
      top: 0;
      left: 0;
      right: 0;
      bottom: 0;
      background: rgba(0, 0, 0, 0.5);
      z-index: 9997;
      display: none;
    }

    .overlay-carrito-temu.mostrar {
      display: block;
    }

    .items-carrito-flotante-temu::-webkit-scrollbar {
      width: 5px;
    }

    .items-carrito-flotante-temu::-webkit-scrollbar-track {
      background: #f1f1f1;
      border-radius: 3px;
    }

    .items-carrito-flotante-temu::-webkit-scrollbar-thumb {
      background: var(--rojo-temu);
      border-radius: 3px;
    }

    /* MEN√ö CATEGOR√çAS M√ìVIL */
    .menu-categorias-movil {
      position: fixed;
      bottom: 150px;
      left: 20px;
      background: #fff;
      border-radius: 15px;
      box-shadow: 0 5px 25px rgba(0,0,0,0.2);
      padding: 1rem;
      z-index: 998;
      display: none;
      flex-direction: column;
      gap: 0.5rem;
      max-height: 300px;
      overflow-y: auto;
      width: 250px;
    }

    .menu-categorias-movil.abierto {
      display: flex;
      animation: slideUp 0.3s ease;
    }

    .footer{
      background:linear-gradient(to right,var(--cafe-oscuro),var(--cafe-medio));
      color:#fff;padding:1.5rem 1rem;margin-top:2.5rem;
    }
    .contenido-footer{max-width:1200px;margin:0 auto;text-align:center}
    .contacto{font-size:1rem;margin-bottom:.6rem;font-weight:900}
    .dirlocal{opacity:.9;margin-bottom:.6rem;font-size:0.9rem}
    .horario{font-style:italic;margin-bottom:0.9rem;opacity:.9;font-size:0.9rem}
    .creditos{font-size:0.85rem;opacity:.8;margin-top:0.9rem}

    @media(max-width:768px){
      .logo{font-size:1.4rem}
      .container{padding:1rem; margin-left: 0;}
      .grid-productos{grid-template-columns:repeat(2, 1fr)}
      .carrito-flotante-temu {
        width: calc(100% - 40px);
        max-height: 70vh;
        bottom: 90px;
      }
      .btn-carrito-flotante-temu {
        min-width: 180px;
        padding: 0.9rem 1.2rem;
        font-size: 0.9rem;
      }
    }
    @media(max-width:480px){
      .grid-productos{grid-template-columns:1fr}
      .producto-temu{padding:0.8rem}
      .btn-carrito-flotante-temu {
        min-width: 150px;
        padding: 0.8rem 1rem;
        font-size: 0.85rem;
      }
    }

    @media(min-width:1024px){
      .carrito-boton-flotante {
        bottom: 30px;
        right: 30px;
      }
      .carrito-flotante-temu {
        bottom: 100px;
        right: 30px;
      }
    }
  </style>
</head>

<body>
  <header class="header">
    <div class="logo">
      <i class="fas fa-coffee"></i>
      <span>De Todos Caf√©</span>
    </div>
    <p class="subtitle">Men√∫ Digital & Pedidos por WhatsApp</p>
  </header>

  <!-- Men√∫ de categor√≠as lateral (escritorio) -->
  <nav class="menu-categorias" id="menuCategorias">
    <!-- Se generar√° din√°micamente -->
  </nav>

  <!-- Men√∫ de categor√≠as m√≥vil -->
  <div class="menu-categorias-movil" id="menuCategoriasMovil">
    <!-- Se generar√° din√°micamente -->
  </div>

  <!-- Bot√≥n para mostrar categor√≠as en m√≥vil -->
  <button class="btn-categorias-movil" id="btnCategoriasMovil">
    <i class="fas fa-bars"></i>
  </button>

  <main class="container">
    <!-- Contenido de categor√≠as se generar√° aqu√≠ -->
    <div id="categoriasContenido"></div>
  </main>

  <!-- Overlay para cerrar carrito -->
  <div class="overlay-carrito-temu" id="overlayCarritoTemu"></div>

  <!-- Carrito flotante estilo Temu -->
  <div class="carrito-flotante-temu" id="carritoFlotanteTemu">
    <div class="cabecera-carrito-flotante-temu">
      <h3>
        <i class="fas fa-shopping-cart"></i>
        Tu Carrito
        <span class="badge-carrito-cabecera-temu" id="badgeCarritoFlotanteTemu">0</span>
      </h3>
      <button class="btn-cerrar-carrito-temu" id="btnCerrarCarritoTemu">
        <i class="fas fa-times"></i> Cerrar
      </button>
    </div>

    <div class="contenido-carrito-flotante-temu">
      <div class="opciones-carrito-flotante-temu">
        <div class="titulo-bloque-flotante-temu">
          <i class="fas fa-sliders"></i> Datos del pedido
        </div>

        <div class="fila-opciones-flotante-temu">
          <div class="label-mini-flotante-temu">Tipo de pedido</div>
          <select id="tipoPedidoFlotanteTemu" class="flotante-temu">
            <option value="domicilio">Domicilio</option>
            <option value="para_llevar">Para llevar</option>
            <option value="consumir_local">Consumir en el local</option>
          </select>
          <div class="mini-ayuda-flotante-temu" id="ayudaEmpaqueFlotanteTemu">
            <i class="fas fa-info-circle"></i> Para llevar / Domicilio: se suma $1.000 por empaque.
          </div>
        </div>

        <div class="fila-opciones-flotante-temu" id="filaDireccionFlotanteTemu" style="display:block;">
          <div class="label-mini-flotante-temu">Direcci√≥n (solo si es domicilio)</div>
          <input id="direccionEntregaFlotanteTemu" class="flotante-temu" type="text" placeholder="Ej: Calle 12 #34-56, Barrio..." />
        </div>

        <div class="fila-opciones-flotante-temu">
          <div class="label-mini-flotante-temu">Forma de pago</div>
          <select id="formaPagoFlotanteTemu" class="flotante-temu">
            <option value="nequi">Nequi</option>
            <option value="efectivo">Efectivo</option>
          </select>
          <div class="mini-ayuda-flotante-temu" id="detallePagoFlotanteTemu">
            <i class="fas fa-money-bill-wave"></i>
            Nequi: 3222096301 ‚Äî Vigny Valencia
          </div>
        </div>

        <div class="fila-opciones-flotante-temu">
          <div class="label-mini-flotante-temu">Nombre de quien recoge</div>
          <input id="nombreClienteFlotanteTemu" class="flotante-temu" type="text" placeholder="Ej: Juan P√©rez" />
        </div>

        <div class="mini-ayuda-flotante-temu">
          <i class="fas fa-clock"></i> Tiempo estimado: <b>30 minutos</b>.
        </div>
      </div>

      <!-- ITEMS -->
      <div class="items-carrito-flotante-temu" id="itemsCarritoFlotanteTemu">
        <div class="mensaje-vacio-flotante-temu">
          <i class="fas fa-shopping-cart"></i>
          <p>Tu carrito est√° vac√≠o</p>
          <p>Agrega productos para comenzar</p>
        </div>
      </div>

      <!-- TOTALES -->
      <div class="total-pedido-flotante-temu">
        <div class="fila-total-flotante-temu">
          <span>Subtotal:</span>
          <span id="subtotalFlotanteTemu">$0</span>
        </div>
        <div class="fila-total-flotante-temu">
          <span>Env√≠o:</span>
          <span id="envioFlotanteTemu">$0</span>
        </div>
        <div class="fila-total-flotante-temu">
          <span>Empaque:</span>
          <span id="empaqueFlotanteTemu">$0</span>
        </div>
        <div class="fila-total-flotante-temu monto-total-flotante-temu">
          <span>Total:</span>
          <span id="totalFlotanteTemu">$0</span>
        </div>
      </div>

      <!-- BOT√ìN WHATSAPP DENTRO DEL CARRITO -->
      <button class="btn-whatsapp-carrito-temu" id="btnWhatsappCarritoTemu" disabled>
        <i class="fab fa-whatsapp"></i> Enviar pedido por WhatsApp
      </button>
    </div>
  </div>

  <!-- Bot√≥n Carrito flotante estilo Temu -->
  <div class="carrito-boton-flotante">
    <button class="btn-carrito-flotante-temu" id="btnCarritoFlotanteTemu">
      <i class="fas fa-shopping-cart"></i>
      <span>Ver Carrito</span>
      <span class="badge-carrito-flotante-temu" id="badgeCarritoBotonTemu">0</span>
    </button>
  </div>

  <footer class="footer">
    <div class="contenido-footer">
      <p class="contacto">
        <i class="fas fa-phone"></i> 
        Pedidos: <a href="tel:+573222096301" style="color:white;text-decoration:underline">322 2096301</a>
      </p>
      <p class="dirlocal">
        <i class="fas fa-location-dot"></i> 
        <span id="localDireccionFooter">Ubicaci√≥n variable - Consultar al hacer pedido</span>
      </p>
      <p class="horario"><i class="fas fa-clock"></i> Lunes a Domingo: 8:00 AM - 8:00 PM</p>
      <p class="creditos">¬© 2026 De Todos Caf√©. Todos los derechos reservados.</p>
    </div>
  </footer>

  <script>
    // ==================== CONFIGURACI√ìN ====================
    const CONFIG = {
      telefonoWhatsApp: "573222096301",
      tiempoEstimadoMin: 30,
      costoEnvioBase: 3000,
      envioGratisDesde: 25000,
      costoEmpaque: 1000,
      nequi: { numero: "3222096301", titular: "Vigny Valencia" },
      localDireccion: "üìç Ubicaci√≥n variable - Consultar disponibilidad al hacer pedido"
    };

    // ==================== MEN√ö (tu carta completa) ====================
    const menuData = {
      categorias: [
        {
          id: "limonadas",
          nombre: "Limonadas Granizadas",
          icono: "glass-whiskey",
          productos: [
            { id: 1, nombre: "Mango sal pimienta", precio: 10000, descripcion: "Refrescante limonada de mango con toque de sal y pimienta", stock: 6, rating: 4.5, ventas: 120 },
            { id: 2, nombre: "Mango + hierbabuena", precio: 11000, descripcion: "Combinaci√≥n perfecta de mango con hierbabuena fresca", stock: 8, rating: 4.7, ventas: 95 },
            { id: 3, nombre: "Mango + pi√±a", precio: 11000, descripcion: "Dulzura tropical de mango y pi√±a", stock: 5, rating: 4.4, ventas: 87 },
            { id: 4, nombre: "Mango + maracuy√°", precio: 11000, descripcion: "Mezcla ex√≥tica de mango y maracuy√°", stock: 7, rating: 4.8, ventas: 110 },
            { id: 5, nombre: "Mango + lulo", precio: 12000, descripcion: "Sabor √∫nico de mango con lulo", stock: 4, rating: 4.6, ventas: 76 },
            { id: 6, nombre: "Mango + mandarina", precio: 12000, descripcion: "Fusi√≥n c√≠trica de mango y mandarina", stock: 9, rating: 4.3, ventas: 82 },
            { id: 7, nombre: "Mango + naranja", precio: 12000, descripcion: "Cl√°sico tropical de mango y naranja", stock: 6, rating: 4.5, ventas: 93 },
            { id: 8, nombre: "Mango + mandarina + manzana", precio: 13000, descripcion: "Tres frutas en una sola bebida", stock: 3, rating: 4.9, ventas: 65 },
            { id: 9, nombre: "Mango + pi√±a + maracuy√°", precio: 13000, descripcion: "Explosi√≥n tropical triple", stock: 5, rating: 4.7, ventas: 88 },
            { id: 10, nombre: "Maracuy√°", precio: 10000, descripcion: "Limonada pura de maracuy√°", stock: 10, rating: 4.4, ventas: 102 },
            { id: 11, nombre: "Maracuy√° + hierbabuena", precio: 11000, descripcion: "Maracuy√° con toque de hierbabuena", stock: 7, rating: 4.6, ventas: 79 },
            { id: 12, nombre: "Lulo", precio: 11000, descripcion: "Aut√©ntico sabor a lulo colombiano", stock: 6, rating: 4.8, ventas: 121 },
            { id: 13, nombre: "Lulo + hierbabuena", precio: 12000, descripcion: "Lulo refrescante con hierbabuena", stock: 4, rating: 4.5, ventas: 67 },
            { id: 14, nombre: "Cereza", precio: 11000, descripcion: "Dulce y √°cida limonada de cereza", stock: 8, rating: 4.3, ventas: 54 },
            { id: 15, nombre: "Cereza + hierbabuena", precio: 12000, descripcion: "Cereza con frescura de hierbabuena", stock: 5, rating: 4.4, ventas: 49 },
            { id: 16, nombre: "Fresa + lim√≥n", precio: 11000, descripcion: "Cl√°sico de fresa con lim√≥n", stock: 9, rating: 4.6, ventas: 112 },
            { id: 17, nombre: "Lim√≥n + hierbabuena", precio: 7000, descripcion: "Refrescante lim√≥n con hierbabuena", stock: 15, rating: 4.2, ventas: 145 },
            { id: 18, nombre: "Manzana", precio: 10000, descripcion: "Limonada suave de manzana", stock: 7, rating: 4.1, ventas: 58 },
            { id: 19, nombre: "Manzana + hierbabuena", precio: 11000, descripcion: "Manzana verde con hierbabuena", stock: 6, rating: 4.3, ventas: 47 },
            { id: 20, nombre: "Pi√±a", precio: 10000, descripcion: "Dulce y tropical limonada de pi√±a", stock: 8, rating: 4.5, ventas: 89 },
            { id: 21, nombre: "Pi√±a + hierbabuena", precio: 11000, descripcion: "Pi√±a con frescura de hierbabuena", stock: 5, rating: 4.4, ventas: 72 },
            { id: 22, nombre: "Mora + fresas", precio: 12000, descripcion: "Mezcla de mora y fresa silvestre", stock: 4, rating: 4.7, ventas: 63 },
            { id: 23, nombre: "Mora", precio: 10000, descripcion: "Intenso sabor a mora", stock: 6, rating: 4.6, ventas: 84 },
            { id: 24, nombre: "Uva", precio: 10000, descripcion: "Limonada dulce de uva", stock: 7, rating: 4.3, ventas: 59 },
            { id: 25, nombre: "Naranja", precio: 10000, descripcion: "Cl√°sica limonada de naranja", stock: 10, rating: 4.2, ventas: 97 },
            { id: 26, nombre: "Naranja + hierbabuena", precio: 11000, descripcion: "Naranja con toque de hierbabuena", stock: 8, rating: 4.4, ventas: 76 },
            { id: 27, nombre: "Mandarina", precio: 11000, descripcion: "Limonada c√≠trica de mandarina", stock: 6, rating: 4.5, ventas: 68 },
            { id: 28, nombre: "Coco", precio: 13000, descripcion: "Ex√≥tica limonada de coco tropical", stock: 3, rating: 4.8, ventas: 41 }
          ]
        },
        {
          id: "sodas",
          nombre: "Sodas",
          icono: "glass-cheers",
          productos: [
            { id: 29, nombre: "Lim√≥n + sal", precio: 6000, descripcion: "Soda refrescante de lim√≥n con sal", stock: 12, rating: 4.0, ventas: 134 },
            { id: 30, nombre: "Soda michelada de Mango", precio: 11000, descripcion: "Michelada tropical de mango", stock: 5, rating: 4.7, ventas: 88 },
            { id: 31, nombre: "Frutos amarillos", precio: 11000, descripcion: "Mezcla de frutas amarillas", stock: 6, rating: 4.4, ventas: 72 },
            { id: 32, nombre: "Frutos rojos", precio: 11000, descripcion: "Combinaci√≥n de frutos rojos", stock: 7, rating: 4.6, ventas: 81 },
            { id: 33, nombre: "Cereza hierbabuena", precio: 11000, descripcion: "Soda de cereza con hierbabuena", stock: 4, rating: 4.3, ventas: 57 },
            { id: 34, nombre: "Manzana verde", precio: 11000, descripcion: "Refrescante soda de manzana verde", stock: 8, rating: 4.2, ventas: 63 },
            { id: 35, nombre: "Michelada de ginger", precio: 11000, descripcion: "Michelada con jengibre", stock: 5, rating: 4.8, ventas: 79 }
          ]
        },
        {
          id: "granizados",
          nombre: "Granizados",
          icono: "snowflake",
          productos: [
            { id: 36, nombre: "Milo", precio: 10000, descripcion: "Granizado cl√°sico de Milo", stock: 9, rating: 4.7, ventas: 156 },
            { id: 37, nombre: "Milo nevado", precio: 11000, descripcion: "Milo con crema y toppings", stock: 7, rating: 4.8, ventas: 142 },
            { id: 38, nombre: "Oreo", precio: 11000, descripcion: "Granizado de galleta Oreo", stock: 6, rating: 4.9, ventas: 167 },
            { id: 39, nombre: "Oreo nevado", precio: 12000, descripcion: "Oreo con crema y trozos de galleta", stock: 4, rating: 4.9, ventas: 133 },
            { id: 40, nombre: "Caf√©", precio: 10000, descripcion: "Granizado de caf√© colombiano", stock: 8, rating: 4.6, ventas: 121 },
            { id: 41, nombre: "Caf√© nevado", precio: 11000, descripcion: "Caf√© con crema y sirope", stock: 5, rating: 4.7, ventas: 98 },
            { id: 42, nombre: "Frapuchino", precio: 12000, descripcion: "Mezcla de caf√© y chocolate", stock: 6, rating: 4.8, ventas: 114 },
            { id: 43, nombre: "Frapuchino nevado", precio: 13000, descripcion: "Frapuchino con crema y toppings", stock: 3, rating: 4.9, ventas: 89 },
            { id: 44, nombre: "Frapuchino whisky", precio: 14000, descripcion: "Frapuchino con toque de whisky", stock: 2, rating: 4.7, ventas: 45 }
          ]
        },
        {
          id: "cremosos",
          nombre: "Cremosos",
          icono: "ice-cream",
          productos: [
            { id: 45, nombre: "Cremoso maracuy√°", precio: 11000, descripcion: "Bebida cremosa de maracuy√°", stock: 7, rating: 4.5, ventas: 78 },
            { id: 46, nombre: "Cremoso mora", precio: 11000, descripcion: "Cremoso de mora silvestre", stock: 5, rating: 4.6, ventas: 69 },
            { id: 47, nombre: "Cremoso uva", precio: 11000, descripcion: "Suave y cremoso de uva", stock: 6, rating: 4.4, ventas: 57 },
            { id: 48, nombre: "Cremoso fresa", precio: 11000, descripcion: "Cremoso cl√°sico de fresa", stock: 8, rating: 4.7, ventas: 92 },
            { id: 49, nombre: "Cremoso frutos rojos", precio: 12000, descripcion: "Mezcla cremosa de frutos rojos", stock: 4, rating: 4.8, ventas: 61 }
          ]
        },
        {
          id: "bebidas_calientes",
          nombre: "Bebidas calientes",
          icono: "mug-hot",
          productos: [
            { id: 50, nombre: "Caf√© de la casa", precio: 1500, descripcion: "Caf√© colombiano tradicional", stock: 20, rating: 4.3, ventas: 245 },
            { id: 51, nombre: "Americano", precio: 3000, descripcion: "Caf√© americano fuerte", stock: 15, rating: 4.4, ventas: 187 },
            { id: 52, nombre: "Caf√© en prensa", precio: 6000, descripcion: "Caf√© preparado en prensa francesa", stock: 8, rating: 4.7, ventas: 112 },
            { id: 53, nombre: "Expreso", precio: 3000, descripcion: "Caf√© expreso intenso", stock: 12, rating: 4.5, ventas: 156 },
            { id: 54, nombre: "Carajillo", precio: 5000, descripcion: "Caf√© con aguardiente", stock: 6, rating: 4.8, ventas: 93 },
            { id: 55, nombre: "Perico", precio: 1500, descripcion: "Caf√© con leche colombiano", stock: 18, rating: 4.2, ventas: 201 },
            { id: 56, nombre: "Caf√© con leche", precio: 2000, descripcion: "Caf√© con leche caliente", stock: 16, rating: 4.3, ventas: 178 },
            { id: 57, nombre: "Espumoso", precio: 7000, descripcion: "Caf√© con espuma de leche", stock: 7, rating: 4.6, ventas: 89 },
            { id: 58, nombre: "Caf√© bomb√≥n", precio: 7000, descripcion: "Caf√© con leche condensada", stock: 9, rating: 4.7, ventas: 104 },
            { id: 59, nombre: "Capuchino whisky", precio: 7000, descripcion: "Capuchino con toque de whisky", stock: 5, rating: 4.8, ventas: 76 },
            { id: 60, nombre: "Capuchino oreo", precio: 7000, descripcion: "Capuchino con galleta Oreo", stock: 4, rating: 4.9, ventas: 121 },
            { id: 61, nombre: "Capuchino masmelo", precio: 7000, descripcion: "Capuchino con malvaviscos", stock: 6, rating: 4.7, ventas: 88 },
            { id: 62, nombre: "Milo caliente", precio: 6000, descripcion: "Bebida caliente de Milo", stock: 10, rating: 4.5, ventas: 134 }
          ]
        },
        {
          id: "infusiones",
          nombre: "Infusiones y arom√°ticas",
          icono: "leaf",
          productos: [
            { id: 63, nombre: "Arom√°tica de panela", precio: 2000, descripcion: "Agua de panela con lim√≥n", stock: 15, rating: 4.1, ventas: 167 },
            { id: 64, nombre: "Infusi√≥n de hierbabuena", precio: 1500, descripcion: "T√© de hierbabuena natural", stock: 12, rating: 4.3, ventas: 98 },
            { id: 65, nombre: "Infusi√≥n de flor de Jamaica", precio: 2000, descripcion: "T√© rojo de flor de Jamaica", stock: 8, rating: 4.4, ventas: 76 },
            { id: 66, nombre: "Arom√°tica de frutos rojos", precio: 5000, descripcion: "Infusi√≥n de frutos rojos", stock: 6, rating: 4.6, ventas: 57 },
            { id: 67, nombre: "Arom√°tica de frutas amarilla", precio: 5000, descripcion: "Infusi√≥n de frutas amarillas", stock: 5, rating: 4.5, ventas: 49 }
          ]
        },
        {
          id: "combos",
          nombre: "Combos especiales",
          icono: "gift",
          productos: [
            { id: 68, nombre: "Agua panela + pan + roscas + queso", precio: 10000, descripcion: "Combo completo para compartir", stock: 6, rating: 4.8, ventas: 89 },
            { id: 69, nombre: "Milo + pan + roscas + queso", precio: 11000, descripcion: "Combo dulce con Milo", stock: 4, rating: 4.7, ventas: 72 },
            { id: 70, nombre: "Migao de chocolate", precio: 11000, descripcion: "Migao tradicional de chocolate", stock: 5, rating: 4.9, ventas: 94 },
            { id: 71, nombre: "Migao de milo", precio: 12000, descripcion: "Migao especial de Milo", stock: 3, rating: 4.8, ventas: 61 }
          ]
        }
      ]
    };

    // ==================== UTILIDADES ====================
    const money = (n) => `$${Number(n || 0).toLocaleString("es-CO")}`;
    const normalizeSpaces = (s) => (s || "").replace(/\s+/g, " ").trim();
    
    // Funci√≥n para generar estrellas de rating
    const renderStars = (rating) => {
      let stars = '';
      const fullStars = Math.floor(rating);
      const hasHalfStar = rating % 1 >= 0.5;
      
      for (let i = 1; i <= 5; i++) {
        if (i <= fullStars) {
          stars += '<i class="fas fa-star"></i>';
        } else if (i === fullStars + 1 && hasHalfStar) {
          stars += '<i class="fas fa-star-half-alt"></i>';
        } else {
          stars += '<i class="far fa-star"></i>';
        }
      }
      return stars;
    };

    // ==================== CARRITO FLOTANTE TEMU ====================
    class CarritoFlotanteTemu {
      constructor(){
        this.items = new Map();
        this.subtotal = 0;
        this.envio = 0;
        this.empaque = 0;
        this.total = 0;
        this.totalItems = 0;
        this.storageKey = "carritoDeTodosCafe_temu_prod";
        this.carritoAbierto = false;
        this.categoriaActual = menuData.categorias[0].id;
        this.menuMovilAbierto = false;

        this.cacheDom();
        this.init();
      }

      cacheDom(){
        // Elementos del carrito flotante Temu
        this.carritoFlotante = document.getElementById("carritoFlotanteTemu");
        this.overlayCarrito = document.getElementById("overlayCarritoTemu");
        this.btnCerrarCarrito = document.getElementById("btnCerrarCarritoTemu");
        this.btnCarritoFlotante = document.getElementById("btnCarritoFlotanteTemu");
        this.itemsCarritoFlotante = document.getElementById("itemsCarritoFlotanteTemu");
        this.badgeCarritoFlotante = document.getElementById("badgeCarritoFlotanteTemu");
        this.badgeCarritoBoton = document.getElementById("badgeCarritoBotonTemu");
        this.subtotalFlotante = document.getElementById("subtotalFlotanteTemu");
        this.envioFlotante = document.getElementById("envioFlotanteTemu");
        this.empaqueFlotante = document.getElementById("empaqueFlotanteTemu");
        this.totalFlotante = document.getElementById("totalFlotanteTemu");
        this.btnWhatsappCarrito = document.getElementById("btnWhatsappCarritoTemu");
        
        // Opciones del carrito flotante
        this.selTipoFlotante = document.getElementById("tipoPedidoFlotanteTemu");
        this.selPagoFlotante = document.getElementById("formaPagoFlotanteTemu");
        this.inpNombreFlotante = document.getElementById("nombreClienteFlotanteTemu");
        this.inpDireccionFlotante = document.getElementById("direccionEntregaFlotanteTemu");
        this.filaDireccionFlotante = document.getElementById("filaDireccionFlotanteTemu");
        this.detallePagoFlotante = document.getElementById("detallePagoFlotanteTemu");
        
        // Men√∫s
        this.menuCategorias = document.getElementById("menuCategorias");
        this.menuCategoriasMovil = document.getElementById("menuCategoriasMovil");
        this.btnCategoriasMovil = document.getElementById("btnCategoriasMovil");
        this.categoriasContenido = document.getElementById("categoriasContenido");
        
        // Footer
        this.footerDir = document.getElementById("localDireccionFooter");
      }

      init(){
        this.footerDir.textContent = CONFIG.localDireccion;

        this.loadFromStorage();
        this.renderMenus();
        this.attachEventListeners();
        this.updateUI();

        // Instrucciones solo una vez
        setTimeout(() => {
          if (!localStorage.getItem("instruccionesVistasDeTodosCafeTemu")){
            alert("üõí ¬°Bienvenido a De Todos Caf√© con estilo Temu!\n\n1) Explora categor√≠as\n2) Agrega productos con 'Agregar'\n3) Toca 'Ver Carrito' para completar tu pedido\n4) ¬°Env√≠a por WhatsApp!\n\n¬°Disfruta de tu experiencia de compra!");
            localStorage.setItem("instruccionesVistasDeTodosCafeTemu", "true");
          }
        }, 700);
      }

      renderMenus(){
        // Renderizar men√∫ lateral (escritorio)
        let menuHTML = '';
        menuData.categorias.forEach(cat => {
          menuHTML += `
            <button class="categoria-btn ${this.categoriaActual === cat.id ? 'activa' : ''}" 
                    data-categoria="${cat.id}">
              <i class="fas fa-${cat.icono}"></i>
              ${cat.nombre}
            </button>
          `;
        });
        this.menuCategorias.innerHTML = menuHTML;

        // Renderizar men√∫ m√≥vil
        this.menuCategoriasMovil.innerHTML = menuHTML;

        // Renderizar contenido de categor√≠as
        this.renderCategoriasContenido();
      }

      renderCategoriasContenido(){
        let contenidoHTML = '';
        menuData.categorias.forEach(cat => {
          const productosHTML = this.renderProductos(cat);
          contenidoHTML += `
            <div class="categoria-contenido ${this.categoriaActual === cat.id ? 'activa' : ''}" 
                 id="categoria-${cat.id}">
              <div class="grid-productos">
                ${productosHTML}
              </div>
            </div>
          `;
        });
        this.categoriasContenido.innerHTML = contenidoHTML;
      }

      renderProductos(cat){
        return cat.productos.map(p => {
          // Determinar si mostrar badge de stock bajo
          const stockBadge = p.stock <= 5 ? `<div class="badge-stock-temu">SOLO QUEDAN ${p.stock}</div>` : '';
          
          // Determinar si mostrar badge de promoci√≥n (ej: cada 5 productos)
          const promoBadge = p.id % 5 === 0 ? `<div class="badge-promo-temu">PROMOCI√ìN</div>` : '';
          
          // Calcular precio original (para mostrar descuento visual)
          const precioOriginal = p.id % 3 === 0 ? Math.round(p.precio * 1.2) : null;
          
          // Mostrar env√≠o gratis para productos sobre cierto precio
          const envioGratis = p.precio >= 12000 ? '<div class="envio-gratis-temu">ENV√çO GRATIS</div>' : '';
          
          // Icono seg√∫n categor√≠a
          const iconoCategoria = cat.icono === 'glass-whiskey' ? 'fa-glass-whiskey' :
                                cat.icono === 'glass-cheers' ? 'fa-glass-cheers' :
                                cat.icono === 'snowflake' ? 'fa-snowflake' :
                                cat.icono === 'ice-cream' ? 'fa-ice-cream' :
                                cat.icono === 'mug-hot' ? 'fa-mug-hot' :
                                cat.icono === 'leaf' ? 'fa-leaf' : 'fa-gift';
          
          return `
            <div class="producto-temu">
              ${stockBadge}
              ${promoBadge}
              <div class="img-placeholder-temu">
                <i class="fas ${iconoCategoria}"></i>
              </div>
              <div class="nombre-producto-temu">${p.nombre}</div>
              <div class="descripcion-corta-temu">${p.descripcion}</div>
              <div class="rating-temu">
                ${renderStars(p.rating)}
                <span>(${p.ventas})</span>
              </div>
              <div class="precio-temu">
                ${precioOriginal ? `<span class="precio-original-temu">${money(precioOriginal)}</span>` : ''}
                ${money(p.precio)}
              </div>
              ${envioGratis}
              <button class="btn-agregar-temu" data-id="${p.id}">
                <i class="fas fa-cart-plus"></i> Agregar
              </button>
            </div>
          `;
        }).join("");
      }

      attachEventListeners(){
        // Bot√≥n para abrir el carrito flotante
        this.btnCarritoFlotante.addEventListener("click", () => {
          this.toggleCarrito();
        });

        // Cerrar carrito
        this.btnCerrarCarrito.addEventListener("click", () => this.cerrarCarrito());
        this.overlayCarrito.addEventListener("click", () => this.cerrarCarrito());

        // Bot√≥n WhatsApp dentro del carrito
        this.btnWhatsappCarrito.addEventListener("click", () => {
          this.validarYEnviarPedido();
        });

        // Bot√≥n para mostrar categor√≠as en m√≥vil
        this.btnCategoriasMovil.addEventListener("click", () => {
          this.toggleMenuMovil();
        });

        // Cerrar men√∫ m√≥vil al hacer clic fuera
        document.addEventListener('click', (e) => {
          if (this.menuMovilAbierto && 
              !this.menuCategoriasMovil.contains(e.target) && 
              !this.btnCategoriasMovil.contains(e.target)) {
            this.cerrarMenuMovil();
          }
        });

        // Tipo de pedido flotante
        this.selTipoFlotante.addEventListener("change", () => {
          this.applyTipoPedidoUI();
        });

        // Forma de pago flotante
        this.selPagoFlotante.addEventListener("change", () => {
          this.applyPagoUI();
        });

        // Inputs flotantes
        this.inpNombreFlotante.addEventListener("input", () => this.updateUI(false));
        this.inpDireccionFlotante.addEventListener("input", () => this.updateUI(false));

        // Delegaci√≥n: botones de categor√≠as
        this.menuCategorias.addEventListener("click", (e) => {
          const btn = e.target.closest('.categoria-btn');
          if (btn) {
            const categoriaId = btn.dataset.categoria;
            this.cambiarCategoria(categoriaId);
          }
        });

        this.menuCategoriasMovil.addEventListener("click", (e) => {
          const btn = e.target.closest('.categoria-btn');
          if (btn) {
            const categoriaId = btn.dataset.categoria;
            this.cambiarCategoria(categoriaId);
            this.cerrarMenuMovil();
          }
        });

        // Delegaci√≥n: botones de agregar productos
        this.categoriasContenido.addEventListener("click", (e) => {
          const btn = e.target.closest("button");
          if (!btn) return;
          
          if (btn.classList.contains('btn-agregar-temu')) {
            const id = Number(btn.dataset.id);
            const prod = this.findProductById(id);
            if (!prod) return;
            this.addItem(prod.id, prod.nombre, prod.precio, 1);
            
            // Efecto visual de a√±adir al carrito
            btn.innerHTML = '<i class="fas fa-check"></i> A√±adido';
            btn.style.background = 'linear-gradient(to right, var(--verde-temu), #2ecc71)';
            setTimeout(() => {
              btn.innerHTML = '<i class="fas fa-cart-plus"></i> Agregar';
              btn.style.background = 'linear-gradient(to right, var(--rojo-temu), var(--naranja-temu))';
            }, 1000);
            
            return;
          }
        });

        // Delegaci√≥n: carrito flotante (+/-/x)
        this.itemsCarritoFlotante.addEventListener("click", (e) => {
          const btn = e.target.closest("button[data-cart]");
          if (!btn) return;
          const action = btn.dataset.cart;
          const id = Number(btn.dataset.id);
          if (!id) return;

          if (action === "inc") this.changeQty(id, 1);
          if (action === "dec") this.changeQty(id, -1);
          if (action === "del") this.removeItem(id);
        });

        // Estado inicial de UI
        this.applyTipoPedidoUI();
        this.applyPagoUI();
      }

      cambiarCategoria(categoriaId){
        // Actualizar bot√≥n activo en men√∫s
        document.querySelectorAll('.categoria-btn').forEach(btn => {
          btn.classList.remove('activa');
          if (btn.dataset.categoria === categoriaId) {
            btn.classList.add('activa');
          }
        });

        // Actualizar contenido visible
        document.querySelectorAll('.categoria-contenido').forEach(contenido => {
          contenido.classList.remove('activa');
          if (contenido.id === `categoria-${categoriaId}`) {
            contenido.classList.add('activa');
          }
        });

        this.categoriaActual = categoriaId;
        
        // Hacer scroll suave hacia arriba
        window.scrollTo({ top: 0, behavior: 'smooth' });
      }

      toggleMenuMovil(){
        if (this.menuMovilAbierto) {
          this.cerrarMenuMovil();
        } else {
          this.abrirMenuMovil();
        }
      }

      abrirMenuMovil(){
        this.menuCategoriasMovil.classList.add('abierto');
        this.menuMovilAbierto = true;
      }

      cerrarMenuMovil(){
        this.menuCategoriasMovil.classList.remove('abierto');
        this.menuMovilAbierto = false;
      }

      validarYEnviarPedido(){
        // Validaci√≥n de nombre
        const nombre = normalizeSpaces(this.inpNombreFlotante.value);
        if (!nombre) {
          alert("Por favor escribe tu nombre en 'Datos del pedido'");
          this.abrirCarrito();
          this.inpNombreFlotante.focus();
          return;
        }
        
        // Validaci√≥n de direcci√≥n para domicilio
        if (this.selTipoFlotante.value === "domicilio") {
          const direccion = normalizeSpaces(this.inpDireccionFlotante.value);
          if (!direccion) {
            alert("Para domicilio, por favor escribe tu direcci√≥n");
            this.abrirCarrito();
            this.inpDireccionFlotante.focus();
            return;
          }
        }
        
        const msg = this.buildWhatsAppMessage();
        const url = `https://wa.me/${CONFIG.telefonoWhatsApp}?text=${encodeURIComponent(msg)}`;
        window.open(url, "_blank");
        
        // Cerrar carrito despu√©s de enviar
        setTimeout(() => this.cerrarCarrito(), 500);
      }

      applyTipoPedidoUI(){
        const t = this.selTipoFlotante.value;
        // Direcci√≥n solo si domicilio
        this.filaDireccionFlotante.style.display = (t === "domicilio") ? "block" : "none";
        if (t !== "domicilio") this.inpDireccionFlotante.value = "";

        // Actualizar totales inmediatamente
        this.updateTotals();
        this.updateUI(false);
      }

      applyPagoUI(){
        const p = this.selPagoFlotante.value;
        if (p === "nequi"){
          this.detallePagoFlotante.innerHTML = `<i class="fas fa-money-bill-wave"></i> Nequi: <b>${CONFIG.nequi.numero}</b> ‚Äî ${CONFIG.nequi.titular}`;
        } else {
          this.detallePagoFlotante.innerHTML = `<i class="fas fa-money-bill-wave"></i> Pago en efectivo (al recibir / en caja)`;
        }
      }

      abrirCarrito(){
        this.carritoFlotante.classList.add('abierto');
        this.overlayCarrito.classList.add('mostrar');
        this.carritoAbierto = true;
      }

      cerrarCarrito(){
        this.carritoFlotante.classList.remove('abierto');
        this.overlayCarrito.classList.remove('mostrar');
        this.carritoAbierto = false;
      }

      toggleCarrito(){
        if (this.carritoAbierto) {
          this.cerrarCarrito();
        } else {
          this.abrirCarrito();
        }
      }

      // ------- Carrito operations -------
      addItem(id, nombre, precio, qty){
        const current = this.items.get(id);
        if (current){
          current.cantidad += qty;
          this.items.set(id, current);
        } else {
          this.items.set(id, { id, nombre, precio, cantidad: qty });
        }
        this.saveToStorage();
        this.updateUI();
        this.toast("‚úÖ Producto agregado al carrito");
        
        // Abrir el carrito autom√°ticamente al agregar un producto
        if (!this.carritoAbierto && this.totalItems === 1) {
          setTimeout(() => this.abrirCarrito(), 300);
        }
      }

      changeQty(id, delta){
        const it = this.items.get(id);
        if (!it) return;
        it.cantidad += delta;
        if (it.cantidad <= 0) this.items.delete(id);
        else this.items.set(id, it);
        this.saveToStorage();
        this.updateUI();
      }

      removeItem(id){
        if (!this.items.has(id)) return;
        this.items.delete(id);
        this.saveToStorage();
        this.updateUI();
        this.toast("üóëÔ∏è Producto eliminado");
      }

      // ------- Totals -------
      updateTotals(){
        this.subtotal = 0;
        this.totalItems = 0;

        this.items.forEach(it => {
          this.subtotal += (it.precio * it.cantidad);
          this.totalItems += it.cantidad;
        });

        // Env√≠o (solo si es domicilio)
        const tipo = this.selTipoFlotante.value;
        if (tipo === "domicilio"){
          this.envio = (this.subtotal >= CONFIG.envioGratisDesde) ? 0 : CONFIG.costoEnvioBase;
        } else {
          this.envio = 0;
        }

        // Empaque (+$1.000) si es domicilio o para llevar
        if (tipo === "domicilio" || tipo === "para_llevar"){
          this.empaque = (this.totalItems > 0) ? CONFIG.costoEmpaque : 0;
        } else {
          this.empaque = 0;
        }

        this.total = this.subtotal + this.envio + this.empaque;
      }

      // ------- UI -------
      updateUI(reRenderCart = true){
        this.updateTotals();

        // Actualizar badges
        this.badgeCarritoFlotante.textContent = String(this.totalItems);
        this.badgeCarritoBoton.textContent = String(this.totalItems);
        
        // Actualizar totales en carrito flotante
        this.subtotalFlotante.textContent = money(this.subtotal);
        this.envioFlotante.textContent = this.envio === 0 ? "Gratis" : money(this.envio);
        this.empaqueFlotante.textContent = money(this.empaque);
        this.totalFlotante.textContent = money(this.total);

        // Habilitar bot√≥n WhatsApp solo si hay items
        this.btnWhatsappCarrito.disabled = (this.totalItems === 0);

        // Render carrito flotante
        if (reRenderCart) this.renderCart();

        // T√≠tulo din√°mico
        document.title = `De Todos Caf√© ${this.totalItems ? `(${this.totalItems})` : ""} - Men√∫ Digital`;
      }

      renderCart(){
        if (this.items.size === 0){
          this.itemsCarritoFlotante.innerHTML = `
            <div class="mensaje-vacio-flotante-temu">
              <i class="fas fa-shopping-cart"></i>
              <p>Tu carrito est√° vac√≠o</p>
              <p>Agrega productos para comenzar</p>
            </div>
          `;
          return;
        }

        let html = "";
        this.items.forEach(it => {
          const totalIt = it.precio * it.cantidad;
          html += `
            <div class="item-carrito-flotante-temu">
              <div class="info-item-flotante-temu">
                <div class="nombre-item-flotante-temu">${it.nombre}</div>
                <div class="precio-unitario-flotante-temu">${money(it.precio)} c/u</div>
                <div class="qty-row-flotante-temu">
                  <button class="btn-qty-flotante-temu" data-cart="dec" data-id="${it.id}">-</button>
                  <span class="qty-flotante-temu">${it.cantidad}</span>
                  <button class="btn-qty-flotante-temu" data-cart="inc" data-id="${it.id}">+</button>
                </div>
              </div>
              <div style="display:flex;flex-direction:column;align-items:flex-end;gap:.4rem;">
                <div class="total-item-flotante-temu">${money(totalIt)}</div>
                <button class="btn-x-flotante-temu" data-cart="del" data-id="${it.id}">
                  <i class="fas fa-trash"></i>
                </button>
              </div>
            </div>
          `;
        });

        this.itemsCarritoFlotante.innerHTML = html;
      }

      // ------- WhatsApp Message (COMPLETA) -------
      buildWhatsAppMessage(){
        const tipo = this.selTipoFlotante.value;
        const pago = this.selPagoFlotante.value;
        const nombre = normalizeSpaces(this.inpNombreFlotante.value);
        const direccion = normalizeSpaces(this.inpDireccionFlotante.value);

        const tipoTxt =
          tipo === "domicilio" ? "Domicilio" :
          tipo === "para_llevar" ? "Para llevar" :
          "Consumir en el local";

        const pagoTxt =
          pago === "nequi" ? `Nequi (${CONFIG.nequi.numero} - ${CONFIG.nequi.titular})` :
          "Efectivo";

        let msg = `¬°Hola! Quisiera hacer un pedido en *De Todos Caf√©* ‚òïÔ∏è\n\n`;
        msg += `üßæ *DATOS DEL PEDIDO*\n`;
        msg += `‚Ä¢ Tipo: *${tipoTxt}*\n`;
        msg += `‚Ä¢ Forma de pago: *${pagoTxt}*\n`;
        msg += `‚Ä¢ Nombre: *${nombre}*\n`;

        if (tipo === "domicilio"){
          msg += `‚Ä¢ Direcci√≥n: *${direccion}*\n`;
        }

        msg += `‚Ä¢ Tiempo estimado: *${CONFIG.tiempoEstimadoMin} min*\n`;
        msg += `‚Ä¢ ${CONFIG.localDireccion}\n`;
        msg += `\n`;

        msg += `üìã *MI PEDIDO*\n`;
        let i = 1;
        this.items.forEach(it => {
          const lineTotal = it.precio * it.cantidad;
          msg += `${i}. ${it.nombre}\n`;
          msg += `   Cantidad: ${it.cantidad}\n`;
          msg += `   Unitario: ${money(it.precio)}\n`;
          msg += `   Subtotal: ${money(lineTotal)}\n\n`;
          i++;
        });

        msg += `‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî\n`;
        msg += `üí∞ Subtotal: ${money(this.subtotal)}\n`;
        msg += `üöö Env√≠o: ${this.envio === 0 ? "Gratis" : money(this.envio)}\n`;
        msg += `üß¥ Empaque: ${money(this.empaque)}\n`;
        msg += `‚úÖ Total a pagar: *${money(this.total)}*\n`;
        msg += `‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî\n\n`;
        msg += `¬øMe confirmas disponibilidad y hora aproximada? ¬°Gracias! üôå`;

        return msg;
      }

      // ------- Storage -------
      saveToStorage(){
        const arr = Array.from(this.items.values());
        localStorage.setItem(this.storageKey, JSON.stringify(arr));
      }

      loadFromStorage(){
        try{
          const raw = localStorage.getItem(this.storageKey);
          if (!raw) return;
          const arr = JSON.parse(raw);
          if (!Array.isArray(arr)) return;
          arr.forEach(it => {
            if (it && it.id && it.nombre && typeof it.precio === "number" && typeof it.cantidad === "number"){
              this.items.set(Number(it.id), { ...it, id: Number(it.id) });
            }
          });
        }catch(e){
          console.error("Storage error:", e);
          localStorage.removeItem(this.storageKey);
        }
      }

      // ------- Helpers -------
      findProductById(id){
        for (const cat of menuData.categorias){
          const p = cat.productos?.find(x => x.id === id);
          if (p) return p;
        }
        return null;
      }

      toast(text){
        const el = document.createElement("div");
        el.style.cssText = `
          position: fixed;
          bottom: 120px;
          right: 20px;
          background: linear-gradient(to right, var(--rojo-temu), var(--naranja-temu));
          color: white;
          padding: 12px 20px;
          border-radius: 10px;
          box-shadow: 0 4px 12px rgba(0,0,0,0.2);
          z-index: 10000;
          font-weight: 900;
          max-width: 300px;
          text-align: center;
          font-size: 0.9rem;
          display: flex;
          align-items: center;
          gap: 0.5rem;
        `;
        el.innerHTML = `<i class="fas fa-check-circle"></i> ${text}`;
        document.body.appendChild(el);
        setTimeout(() => {
          el.style.opacity = "0";
          el.style.transition = "opacity 0.3s ease";
          setTimeout(() => el.remove(), 300);
        }, 2000);
      }
    }

    // ==================== INIT ====================
    let carritoTemu;
    document.addEventListener("DOMContentLoaded", () => {
      carritoTemu = new CarritoFlotanteTemu();
    });
  </script>
</body>
</html>